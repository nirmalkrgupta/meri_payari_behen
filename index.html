<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Lovely Sister</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: "Poppins", sans-serif;
        }

        body {
            background-color: #fff5f6;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            /* Ensure body takes full viewport height for centering */
            min-height: 100vh;
            padding: 20px 0;
            text-align: center;
        }

        /* NEW WRAPPER: Ensures only one card takes up space at a time and maintains center */
        .card-wrapper {
            position: relative;
            width: 90%;
            max-width: 500px;
            /* Set a fixed height for the wrapper based on the tallest container */
            min-height: 600px; 
        }

        .container {
            width: 100%;
            padding: 30px;
            background: #fff;
            border-radius: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            transition: opacity 0.6s ease, transform 0.6s ease;
            position: absolute; /* Crucial: Stack the pages on top of each other */
            top: 0;
            left: 0;
            opacity: 1; /* Default visible state for transition */
            visibility: visible;
            
            /* Ensure content inside container respects flex for page 4 */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            min-height: inherit; /* Inherit height from wrapper */
        }

        .hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none; /* Disable interaction when hidden */
        }
        
        /* The fade animation is now implicitly handled by opacity/transform transitions */
        .fade {
            /* This class is now primarily used by JS to mark the visible element */
            opacity: 1;
            visibility: visible;
            transform: scale(1);
        }
        
        /* --- TYPOGRAPHY --- */
        h1 {
            font-size: 2rem;
            color: #f27d9d;
        }

        h2 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        p {
            font-size: 1rem;
            line-height: 1.6;
            margin: 20px 0;
        }

        img {
            width: 150px;
            margin-top: 10px;
        }
        /* --- BUTTONS --- */
        .buttons {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            width: 100%; /* Important for centering */
        }

        button {
            background-color: #f27d9d;
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: 0.3s;
            margin: 0 5px;
        }

        button:hover {
            background-color: #f45c8c;
        }

        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            color: #777;
        }

        .back {
            background-color: #dbe7ff;
            color: #333;
        }

        .back:hover {
            background-color: #bcd3ff;
        }

        .next {
            background-color: #fcd0da;
            color: #333;
        }

        .next:hover {
            background-color: #f9b7c7;
        }
        
        /* --- BACKGROUNDS --- */
        #page1 {
            background: #fff;
        }

        .page2, .page3 { /* Added .page3 to the same style as page2 */
            background: linear-gradient(120deg, #ffe6eb, #fff);
        }

        .page4 { /* Updated from page3 */
            background: linear-gradient(120deg, #fff5f8, #fff);
        }

        /* --- CONTENT ANIMATIONS (Keep them) --- */
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slideUp {
            opacity: 0;
            transform: translateY(20px);
            animation: slideUp 0.6s ease-out forwards;
        }
        
        /* --- CHOCOLATE GAME GRID (PAGE 4 - was Page 3) --- */
        .game-content {
            flex-grow: 1; /* Allow content to push buttons down */
            width: 100%;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 25px auto;
            max-width: 300px;
            filter: blur(0px);
            transition: filter 0.6s ease;
            pointer-events: auto;
        }

        .cell {
            width: 90px;
            height: 90px;
            /* ... cell styles ... */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            border: 2px solid #f27d9d;
            border-radius: 15px;
            cursor: pointer;
            background: #fff;
            transition: background 0.3s, transform 0.1s;
        }
        
        .blank-cell {
            background-color: #fce4ec;
            border-color: #f27d9d;
            animation: jiggle 1.5s ease-in-out infinite alternate;
        }
        @keyframes jiggle {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(0.5deg) scale(1.01); }
            100% { transform: rotate(-0.5deg) scale(1); }
        }

        .grid.blurred {
            filter: blur(3px);
            pointer-events: none;
        }
        
        .game-overlay-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            /* ... overlay styles ... */
            background: rgba(255, 255, 255, 0.95);
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            z-index: 10;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
            pointer-events: none;
            color: #f27d9d;
            font-size: 1.6rem;
            font-weight: 700;
        }

        .game-overlay-message.show {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
        
        /* --- PAGE 5: LETTER STYLES (was Page 4) --- */
        /* MODIFIED: Added img1.jpg background with a gradient overlay for readability */
        #page5 { 
            background: linear-gradient(135deg, rgba(255,255,255,0.7), rgba(255,238,242,0.7)), url('img1.jpg') no-repeat center center;
            background-size: cover;
            padding-bottom: 80px; /* Add space for the absolute buttons */
        }

        #page5 .letter-header {
            width: 100%; /* Take up space */
            margin-bottom: 20px;
            animation-delay: 0.1s;
        }

        #page5 .letter-content {
            text-align: left;
            width: 100%;
            max-width: 350px;
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
            animation-delay: 0.3s;
        }

        #page5 .dear-shital {
            text-align: center;
            opacity: 0;
            transform: scale(0.8);
            animation: scaleIn 0.5s ease-out 0.5s forwards;
        }
        @keyframes scaleIn {
            to { opacity: 1; transform: scale(1); }
        }

        #page5 .shin-chan-image {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 50px;
            z-index: 2;
            opacity: 0;
            transform: translateX(30px);
            animation: slideLeftIn 0.6s ease-out 0.7s forwards;
        }
        @keyframes slideLeftIn {
            to { opacity: 1; transform: translateX(0); }
        }

        .happy-bhaidooj-stamp {
            position: absolute;
            bottom: 50px; /* Adjusted from 120px to account for padding */
            left: 20px;
            width: 120px;
            height: 120px;
            border: 2px dashed #f27d9d;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #ffeef2;
            padding: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transform: rotate(-10deg) scale(0);
            opacity: 0;
            animation: stampDrop 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) 1s forwards;
        }

        @keyframes stampDrop {
            to {
                transform: rotate(-10deg) scale(1);
                opacity: 1;
            }
        }

        /* FIX: Re-positioning buttons on Page 5 to be truly at the bottom */
        #page5 > .buttons {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: 90%; /* Maintain container width context */
        }
        
        /* --- RESPONSIVENESS (Mobile/Small Screens) --- */
        @media (max-width: 480px) {
            .card-wrapper {
                min-height: 550px;
            }
            .container {
                padding: 15px;
                border-radius: 18px;
            }
            h1 { font-size: 1.6rem; }
            h2 { font-size: 1.2rem; }
            p { font-size: 0.9rem; }
            .cell { width: 75px; height: 75px; font-size: 1.5rem; }
            
            #page5 .shin-chan-image {
                top: -50px;
                right: 10px;
                width: 80px;
            }
            .happy-bhaidooj-stamp {
                bottom: 90px;
                left: 210px;
                width: 100px;
                height: 100px;
            }
            /* ADDED: Mobile adjustments for stamp text and heart */
            .happy-bhaidooj-stamp .heart-icon { font-size: 1.5rem; }
            .happy-bhaidooj-stamp .stamp-text { font-size: 0.65rem; }
            #page5 .dear-shital { font-size: 1.1rem; }
        }
    </style>
</head>
<body>
    <audio id="backgroundMusic" loop preload="auto">
        <source src="song.mp3" type="audio/mp3"> 
        Your browser does not support the audio element.
    </audio>

    <div class="card-wrapper">
        <div class="container fade" id="page1">
            <div class="game-content">
                <h2 class="slideUp" style="animation-delay: 0.1s;">FOR MY LOVELY <br><b style="color: #f27d9d; font-size: 25px;">&nbsp; &nbsp;SISTER ✨</b></h2>
                <h1 class="slideUp" style="animation-delay: 0.3s;"></h1>
                <p class="slideUp" style="animation-delay: 0.7s;">
                    I have created something special just for you to show how much you mean to me. <br>I hope you love it as much as I loved creating it for you. ❤️
                </p><br>
                <img class="slideUp" style="animation-delay: 0.1s; width: 270px;" src="intro.gif" alt="Bhai Dooj animated image">
            </div>
            <div class="buttons slideUp" style="animation-delay: 1.1s;">
                <button onclick="nextPage(2); startMusic()">Next →</button>
            </div>
        </div>

        <div class="container hidden page2" id="page2">
            <div class="game-content">
                <h1 class="slideUp" style="animation-delay: 0.1s;">Our Precious Memories 📸</h1>
                <p class="slideUp" style="animation-delay: 0.3s;">
                    You’ve always been my biggest supporter, my secret keeper, and my forever partner-in-crime. 💫
                </p><br><br>
                <video class="slideUp" style="animation-delay: 0.5s; width: 270px;" id="page2-video" autoplay loop muted playsinline>
                    <source src="vid.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <div class="buttons slideUp" style="animation-delay: 0.7s;">
                <button class="back" onclick="prevPage(1)">← Back</button>
                <button class="next" onclick="nextPage(3)">Next →</button> </div>
        </div>
        
        <div class="container hidden page3" id="page3">
            <div class="game-content">
                <h1 class="slideUp" style="animation-delay: 0.1s;">🌸 A Special Bond 🌸</h1>
                <p class="slideUp" style="animation-delay: 0.3s;">
                    No matter how old we get and where life takes us, we will always be together because brother and sister are forever. I’m so lucky to have you by my side.
                </p><br><br>
                <video class="slideUp" style="animation-delay: 0.5s; width: 270px;" id="page3-video" autoplay loop muted playsinline>
                    <source src="vid2.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <div class="buttons slideUp" style="animation-delay: 0.7s;">
                <button class="back" onclick="prevPage(2)">← Back</button> <button class="next" onclick="nextPage(4)">Next →</button> </div>
        </div>

        <div class="container hidden page4" id="page4">
            <div class="game-content">
                <h1 class="slideUp" style="animation-delay: 0.1s;">Fill in the blanks to get a chocolate 🍫</h1>

                <div class="grid slideUp" id="grid" style="animation-delay: 0.3s;">
                    <div class="cell" tabindex="0" aria-label="A chocolate icon, already filled">🍫</div>
                    <div class="cell" tabindex="0" aria-label="A red cross icon, already filled">❌</div>
                    <div class="cell" tabindex="0" aria-label="A red cross icon, already filled">❌</div>
                    <div class="cell" tabindex="0" aria-label="A red cross icon, already filled">❌</div>
                    <div class="cell blank-cell" tabindex="0" aria-label="Click or press enter/space to fill this blank space"></div>
                    <div class="cell" tabindex="0" aria-label="A red cross icon, already filled">❌</div>
                    <div class="cell" tabindex="0" aria-label="A red cross icon, already filled">❌</div>
                    <div class="cell" tabindex="0" aria-label="A red cross icon, already filled">❌</div>
                    <div class="cell" tabindex="0" aria-label="A chocolate icon, already filled">🍫</div>
                </div>
            </div>

            <div class="game-overlay-message" id="gameOverlayMessage">
                You have successfully unlocked a chocolate treat! 🍫
            </div>

            <div class="buttons slideUp" style="animation-delay: 0.5s;">
                <button class="back" onclick="prevPage(3)">← Back</button> <button class="next" id="gameNextButton" onclick="nextPage(5)" disabled>Next →</button> </div>
        </div>

        <div class="container hidden" id="page5">
            <div class="letter-header slideUp" style="animation-delay: 0.1s;">
                <h2>A LETTER</h2>
                <h1>FROM YOUR BHAI ✨</h1>
            </div>
            <div class="letter-content slideUp" style="animation-delay: 0.3s;">
                <p class="dear-shital">Dear Behen ❤️</p>
                <p>
                    I just wanted to remind you behen, how much you truly mean to me. You’ve always been there, not just as a sister, but as my guide, my support, and my safe place. Every time I faced a challenge, no matter how big or small, you were there-encouraging me, lifting me up, and reminding me of my strength. I love you so much meri behen!💖
                </p>
                <p class="closing">With love, your brother 💌</p>
            </div>
            <img src="sin.gif" alt="Shin Chan cartoon character" class="shin-chan-image" />
            
            <div class="happy-bhaidooj-stamp">
                <span class="heart-icon" style="font-size: 2rem; color: #f27d9d;">❤️</span>
                <span class="stamp-text" style="font-size: 0.75rem; font-weight: 700; color: #f27d9d;">HAPPY BHAI DOOJ</span>
            </div>

            <div class="buttons">
                <button class="back" onclick="prevPage(4)">← Back</button> </div>
        </div>
    </div>

    <script>
        const backgroundMusic = document.getElementById("backgroundMusic");
        const gameNextButton = document.getElementById("gameNextButton");
        const gameOverlayMessage = document.getElementById("gameOverlayMessage");
        const gameGrid = document.getElementById("grid");
        const blankCell = document.querySelector(".blank-cell"); 
        
        let musicStarted = false; // Track if the music has been initialized

        /**
         * Starts the background music. This function is called only once
         * when the user clicks 'Next' on Page 1, satisfying browser autoplay policies.
         */
        function startMusic() {
            if (!musicStarted) {
                backgroundMusic.volume = 0.5; // Set volume lower so it doesn't overpower the page
                backgroundMusic.play().catch(error => {
                    console.log("Autoplay prevented:", error);
                });
                musicStarted = true;
            }
        }

        /**
         * Hides all pages and shows the target page, running the fade animation.
         * @param {number} n The page number to show (e.g., 1, 2, 3, 4, 5).
         */
        function nextPage(n) {
            document.querySelectorAll(".container").forEach(div => {
                div.classList.add("hidden");
                // Remove slideUp animations to reset them
                div.querySelectorAll('.slideUp').forEach(el => el.style.animationName = 'none');
            });

            const next = document.getElementById("page" + n);
            // Force reflow by reading a property before re-applying the animation
            void next.offsetWidth; 
            
            next.classList.remove("hidden");
            // Re-apply slideUp animations to visible content
            next.querySelectorAll('.slideUp').forEach(el => el.style.animationName = 'slideUp');
            
            // Check if the game page is the next page (Page 4)
            if (n === 4) { 
                resetGame(); // Reset game state when entering page 4
            }
        }

        /**
         * Hides all pages and shows the target page, running the fade animation (for going back).
         * @param {number} n The page number to show (e.g., 1, 2, 3, 4, 5).
         */
        function prevPage(n) {
            document.querySelectorAll(".container").forEach(div => {
                div.classList.add("hidden");
                div.querySelectorAll('.slideUp').forEach(el => el.style.animationName = 'none');
            });

            const prev = document.getElementById("page" + n);
            void prev.offsetWidth;
            
            prev.classList.remove("hidden");
            prev.querySelectorAll('.slideUp').forEach(el => el.style.animationName = 'slideUp');
        }

        /**
         * Resets the game state: clears the blank cell, hides the message, blurs the grid, disables button.
         */
        function resetGame() {
            // Find the blank cell specifically on page 4
            const page4BlankCell = document.querySelector("#page4 .blank-cell");
            
            page4BlankCell.textContent = "";
            page4BlankCell.classList.add("blank-cell");
            page4BlankCell.style.pointerEvents = 'auto';
            gameNextButton.disabled = true;
            gameNextButton.style.backgroundColor = '';
            gameNextButton.style.color = '';
            gameOverlayMessage.classList.remove("show");
            gameGrid.classList.remove("blurred");
            page4BlankCell.setAttribute("aria-label", "Click or press enter/space to fill this blank space");
        }

        /**
         * Handles filling the single blank cell and triggering the win state.
         */
        function handleBlankCellClick(event) {
            if (event.currentTarget === blankCell && blankCell.textContent.trim() === "") {
                blankCell.textContent = "🍫";
                blankCell.classList.remove("blank-cell");
                blankCell.style.pointerEvents = 'none';
                blankCell.setAttribute("aria-label", "Chocolate unlocked!");

                gameOverlayMessage.classList.add("show");
                gameGrid.classList.add("blurred");

                gameNextButton.disabled = false;
                gameNextButton.style.backgroundColor = '#f27d9d';
                gameNextButton.style.color = 'white';
                gameNextButton.focus();
            }
        }

        // Attach event listeners to the single blank cell
        blankCell.addEventListener("click", handleBlankCellClick);
        blankCell.addEventListener("keydown", (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                handleBlankCellClick(e);
            }
        });

        // Initial setup: Hide all except page 1, and ensure page 1 content animation runs
        document.addEventListener('DOMContentLoaded', () => {
            // Start by hiding all pages except the first one explicitly
            document.querySelectorAll(".container").forEach(div => div.classList.add("hidden"));
            document.getElementById('page1').classList.remove('hidden');
            // Re-apply slideUp animations to the first page's content
            document.getElementById('page1').querySelectorAll('.slideUp').forEach(el => el.style.animationName = 'slideUp');
        });
    </script>
</body>
</html>